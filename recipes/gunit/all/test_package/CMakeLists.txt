cmake_minimum_required(VERSION 3.16)
project(test_package CXX)
set(CMAKE_VERBOSE_MAKEFILE ON)
find_package(gunit REQUIRED CONFIG)

function(test name scenario)
  string(REPLACE "/" "_" out ${name})
  add_executable(${out} ${CMAKE_CURRENT_LIST_DIR}/${name}.cpp)
  add_test(${out} ./${out})
  target_link_libraries(${out} gunit::gunit)
  add_custom_command(TARGET ${out} COMMAND ${scenario} ./${out} --gtest_color=yes USES_TERMINAL)
endfunction()

enable_testing()

test(GAssert SCENARIO=)
test(GMock SCENARIO=)
test(GTest SCENARIO=)
test(GTest-Lite SCENARIO=)
test(GSteps SCENARIO=${CMAKE_CURRENT_SOURCE_DIR}/GSteps.feature)
